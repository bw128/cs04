// Copyright 2021, University of Colorado Boulder

/**
 * Generally a "one-stop shop" for all things needed to update the PhET Codebase. This will:
 * - clone missing repos
 * - pull all repos
 * - set up tracking to the remote (only if needed)
 * - npm update in chipper/perennial/perennial-alias
 * - transpile (see --transpile)
 * - Conduct pull and tracking on all branches associated with the repo (see --allBranches) (useful for doing batch MRs)
 *
 * @author Jonathan Olson <jonathan.olson@colorado.edu>
 */

const cloneMissingRepos = require('../common/cloneMissingRepos');
const execute = require('../common/execute');
const getActiveRepos = require('../common/getActiveRepos');
const getBranches = require('../common/getBranches');
const gitCheckout = require('../common/gitCheckout');
const gitIsClean = require('../common/gitIsClean');
const gitPullRebase = require('../common/gitPullRebase');
const gitRevParse = require('../common/gitRevParse');
const npmUpdate = require('../common/npmUpdate');
const outputJSAll = require('../common/outputJSAll');
const winston = require('../../../../../../perennial-alias/node_modules/winston');
const _ = require('lodash');
winston.default.transports.console.level = 'error';

// If this is provided, we'll track ALL remote branches, check them out, and pull them (with rebase)
const allBranches = process.argv.includes('--allBranches');

// Additionally run the transpiler after pulling
const transpile = process.argv.includes('--transpile');

// Log all repos, even if nothing changed with them.
const allRepos = process.argv.includes('--all');

// ANSI escape sequences to move to the right (in the same line) or to apply or reset colors
const moveRight = ' \u001b[42G';
const red = '\u001b[31m';
const green = '\u001b[32m';
const reset = '\u001b[0m';
const repos = getActiveRepos();
const data = {};
const getStatus = async repo => {
  data[repo] = '';
  try {
    if (await gitIsClean(repo)) {
      if (allBranches) {
        const branches = await getBranches(repo);
        for (const branch of branches) {
          // Only track the remote branch if it hasn't been tracked yet
          if ((await execute('git', ['rev-parse', '--verify', branch], `../${repo}`, {
            errors: 'resolve'
          })).code !== 0) {
            await execute('git', ['branch', '--track', branch, `origin/${branch}`], `../${repo}`);
          }
          await gitCheckout(repo, branch);
          try {
            await gitPullRebase(repo);
          } catch (e) {
            // Likely there is no tracking info set up on the local branch
            await execute('git', ['branch', `--set-upstream-to=origin/${branch}`, branch], `../${repo}`);
            await gitPullRebase(repo);
          }
        }

        // Go back to main
        await gitCheckout(repo, 'main');
      } else {
        await gitCheckout(repo, 'main');
        await gitPullRebase(repo);
      }
    } else if (repo === 'perennial') {
      console.log(`${red}perennial is not clean, skipping pull${reset}`);
    }
    if (repo === 'perennial') {
      await cloneMissingRepos();
    }
    const symbolicRef = (await execute('git', ['symbolic-ref', '-q', 'HEAD'], `../${repo}`)).trim();
    const branch = symbolicRef.replace('refs/heads/', ''); // might be empty string
    const sha = await gitRevParse(repo, 'HEAD');
    const status = await execute('git', ['status', '--porcelain'], `../${repo}`);
    const track = branch ? (await execute('git', ['for-each-ref', '--format=%(push:track,nobracket)', symbolicRef], `../${repo}`)).trim() : '';
    let isGreen = false;
    if (branch) {
      isGreen = !status && branch === 'main' && !track.length;
      if (!isGreen || allRepos) {
        data[repo] += `${repo}${moveRight}${isGreen ? green : red}${branch}${reset} ${track}\n`;
      }
    } else {
      // if no branch, print our SHA (detached head)
      data[repo] += `${repo}${moveRight}${red}${sha}${reset}\n`;
    }
    if (status) {
      if (!isGreen || allRepos) {
        data[repo] += status + '\n';
      }
    }
  } catch (e) {
    data[repo] += `${repo} ERROR: ${e}`;
  }
};
(async () => {
  await Promise.all(repos.map(repo => getStatus(repo)));
  repos.forEach(repo => {
    process.stdout.write(data[repo]);
  });
  console.log(`${_.every(repos, repo => !data[repo].length) ? green : red}-----=====] finished pulls [=====-----${reset}\n`);
  await npmUpdate('chipper');
  await npmUpdate('perennial');
  await npmUpdate('perennial-alias');
  console.log(`${_.every(repos, repo => !data[repo].length) ? green : red}-----=====] finished npm [=====-----${reset}\n`);
  if (transpile) {
    await outputJSAll();
    console.log(`${_.every(repos, repo => !data[repo].length) ? green : red}-----=====] finished transpile [=====-----${reset}\n`);
  }
})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJjbG9uZU1pc3NpbmdSZXBvcyIsInJlcXVpcmUiLCJleGVjdXRlIiwiZ2V0QWN0aXZlUmVwb3MiLCJnZXRCcmFuY2hlcyIsImdpdENoZWNrb3V0IiwiZ2l0SXNDbGVhbiIsImdpdFB1bGxSZWJhc2UiLCJnaXRSZXZQYXJzZSIsIm5wbVVwZGF0ZSIsIm91dHB1dEpTQWxsIiwid2luc3RvbiIsIl8iLCJkZWZhdWx0IiwidHJhbnNwb3J0cyIsImNvbnNvbGUiLCJsZXZlbCIsImFsbEJyYW5jaGVzIiwicHJvY2VzcyIsImFyZ3YiLCJpbmNsdWRlcyIsInRyYW5zcGlsZSIsImFsbFJlcG9zIiwibW92ZVJpZ2h0IiwicmVkIiwiZ3JlZW4iLCJyZXNldCIsInJlcG9zIiwiZGF0YSIsImdldFN0YXR1cyIsInJlcG8iLCJicmFuY2hlcyIsImJyYW5jaCIsImVycm9ycyIsImNvZGUiLCJlIiwibG9nIiwic3ltYm9saWNSZWYiLCJ0cmltIiwicmVwbGFjZSIsInNoYSIsInN0YXR1cyIsInRyYWNrIiwiaXNHcmVlbiIsImxlbmd0aCIsIlByb21pc2UiLCJhbGwiLCJtYXAiLCJmb3JFYWNoIiwic3Rkb3V0Iiwid3JpdGUiLCJldmVyeSJdLCJzb3VyY2VzIjpbIm1haW4tcHVsbC1zdGF0dXMuanMiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gQ29weXJpZ2h0IDIwMjEsIFVuaXZlcnNpdHkgb2YgQ29sb3JhZG8gQm91bGRlclxyXG5cclxuLyoqXHJcbiAqIEdlbmVyYWxseSBhIFwib25lLXN0b3Agc2hvcFwiIGZvciBhbGwgdGhpbmdzIG5lZWRlZCB0byB1cGRhdGUgdGhlIFBoRVQgQ29kZWJhc2UuIFRoaXMgd2lsbDpcclxuICogLSBjbG9uZSBtaXNzaW5nIHJlcG9zXHJcbiAqIC0gcHVsbCBhbGwgcmVwb3NcclxuICogLSBzZXQgdXAgdHJhY2tpbmcgdG8gdGhlIHJlbW90ZSAob25seSBpZiBuZWVkZWQpXHJcbiAqIC0gbnBtIHVwZGF0ZSBpbiBjaGlwcGVyL3BlcmVubmlhbC9wZXJlbm5pYWwtYWxpYXNcclxuICogLSB0cmFuc3BpbGUgKHNlZSAtLXRyYW5zcGlsZSlcclxuICogLSBDb25kdWN0IHB1bGwgYW5kIHRyYWNraW5nIG9uIGFsbCBicmFuY2hlcyBhc3NvY2lhdGVkIHdpdGggdGhlIHJlcG8gKHNlZSAtLWFsbEJyYW5jaGVzKSAodXNlZnVsIGZvciBkb2luZyBiYXRjaCBNUnMpXHJcbiAqXHJcbiAqIEBhdXRob3IgSm9uYXRoYW4gT2xzb24gPGpvbmF0aGFuLm9sc29uQGNvbG9yYWRvLmVkdT5cclxuICovXHJcblxyXG5jb25zdCBjbG9uZU1pc3NpbmdSZXBvcyA9IHJlcXVpcmUoICcuLi9jb21tb24vY2xvbmVNaXNzaW5nUmVwb3MnICk7XHJcbmNvbnN0IGV4ZWN1dGUgPSByZXF1aXJlKCAnLi4vY29tbW9uL2V4ZWN1dGUnICk7XHJcbmNvbnN0IGdldEFjdGl2ZVJlcG9zID0gcmVxdWlyZSggJy4uL2NvbW1vbi9nZXRBY3RpdmVSZXBvcycgKTtcclxuY29uc3QgZ2V0QnJhbmNoZXMgPSByZXF1aXJlKCAnLi4vY29tbW9uL2dldEJyYW5jaGVzJyApO1xyXG5jb25zdCBnaXRDaGVja291dCA9IHJlcXVpcmUoICcuLi9jb21tb24vZ2l0Q2hlY2tvdXQnICk7XHJcbmNvbnN0IGdpdElzQ2xlYW4gPSByZXF1aXJlKCAnLi4vY29tbW9uL2dpdElzQ2xlYW4nICk7XHJcbmNvbnN0IGdpdFB1bGxSZWJhc2UgPSByZXF1aXJlKCAnLi4vY29tbW9uL2dpdFB1bGxSZWJhc2UnICk7XHJcbmNvbnN0IGdpdFJldlBhcnNlID0gcmVxdWlyZSggJy4uL2NvbW1vbi9naXRSZXZQYXJzZScgKTtcclxuY29uc3QgbnBtVXBkYXRlID0gcmVxdWlyZSggJy4uL2NvbW1vbi9ucG1VcGRhdGUnICk7XHJcbmNvbnN0IG91dHB1dEpTQWxsID0gcmVxdWlyZSggJy4uL2NvbW1vbi9vdXRwdXRKU0FsbCcgKTtcclxuY29uc3Qgd2luc3RvbiA9IHJlcXVpcmUoICd3aW5zdG9uJyApO1xyXG5jb25zdCBfID0gcmVxdWlyZSggJ2xvZGFzaCcgKTtcclxuXHJcbndpbnN0b24uZGVmYXVsdC50cmFuc3BvcnRzLmNvbnNvbGUubGV2ZWwgPSAnZXJyb3InO1xyXG5cclxuLy8gSWYgdGhpcyBpcyBwcm92aWRlZCwgd2UnbGwgdHJhY2sgQUxMIHJlbW90ZSBicmFuY2hlcywgY2hlY2sgdGhlbSBvdXQsIGFuZCBwdWxsIHRoZW0gKHdpdGggcmViYXNlKVxyXG5jb25zdCBhbGxCcmFuY2hlcyA9IHByb2Nlc3MuYXJndi5pbmNsdWRlcyggJy0tYWxsQnJhbmNoZXMnICk7XHJcblxyXG4vLyBBZGRpdGlvbmFsbHkgcnVuIHRoZSB0cmFuc3BpbGVyIGFmdGVyIHB1bGxpbmdcclxuY29uc3QgdHJhbnNwaWxlID0gcHJvY2Vzcy5hcmd2LmluY2x1ZGVzKCAnLS10cmFuc3BpbGUnICk7XHJcblxyXG4vLyBMb2cgYWxsIHJlcG9zLCBldmVuIGlmIG5vdGhpbmcgY2hhbmdlZCB3aXRoIHRoZW0uXHJcbmNvbnN0IGFsbFJlcG9zID0gcHJvY2Vzcy5hcmd2LmluY2x1ZGVzKCAnLS1hbGwnICk7XHJcblxyXG4vLyBBTlNJIGVzY2FwZSBzZXF1ZW5jZXMgdG8gbW92ZSB0byB0aGUgcmlnaHQgKGluIHRoZSBzYW1lIGxpbmUpIG9yIHRvIGFwcGx5IG9yIHJlc2V0IGNvbG9yc1xyXG5jb25zdCBtb3ZlUmlnaHQgPSAnIFxcdTAwMWJbNDJHJztcclxuY29uc3QgcmVkID0gJ1xcdTAwMWJbMzFtJztcclxuY29uc3QgZ3JlZW4gPSAnXFx1MDAxYlszMm0nO1xyXG5jb25zdCByZXNldCA9ICdcXHUwMDFiWzBtJztcclxuXHJcbmNvbnN0IHJlcG9zID0gZ2V0QWN0aXZlUmVwb3MoKTtcclxuY29uc3QgZGF0YSA9IHt9O1xyXG5cclxuY29uc3QgZ2V0U3RhdHVzID0gYXN5bmMgcmVwbyA9PiB7XHJcbiAgZGF0YVsgcmVwbyBdID0gJyc7XHJcblxyXG4gIHRyeSB7XHJcbiAgICBpZiAoIGF3YWl0IGdpdElzQ2xlYW4oIHJlcG8gKSApIHtcclxuICAgICAgaWYgKCBhbGxCcmFuY2hlcyApIHtcclxuICAgICAgICBjb25zdCBicmFuY2hlcyA9IGF3YWl0IGdldEJyYW5jaGVzKCByZXBvICk7XHJcbiAgICAgICAgZm9yICggY29uc3QgYnJhbmNoIG9mIGJyYW5jaGVzICkge1xyXG4gICAgICAgICAgLy8gT25seSB0cmFjayB0aGUgcmVtb3RlIGJyYW5jaCBpZiBpdCBoYXNuJ3QgYmVlbiB0cmFja2VkIHlldFxyXG4gICAgICAgICAgaWYgKCAoIGF3YWl0IGV4ZWN1dGUoICdnaXQnLCBbICdyZXYtcGFyc2UnLCAnLS12ZXJpZnknLCBicmFuY2ggXSwgYC4uLyR7cmVwb31gLCB7IGVycm9yczogJ3Jlc29sdmUnIH0gKSApLmNvZGUgIT09IDAgKSB7XHJcbiAgICAgICAgICAgIGF3YWl0IGV4ZWN1dGUoICdnaXQnLCBbICdicmFuY2gnLCAnLS10cmFjaycsIGJyYW5jaCwgYG9yaWdpbi8ke2JyYW5jaH1gIF0sIGAuLi8ke3JlcG99YCApO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgICAgYXdhaXQgZ2l0Q2hlY2tvdXQoIHJlcG8sIGJyYW5jaCApO1xyXG5cclxuICAgICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgIGF3YWl0IGdpdFB1bGxSZWJhc2UoIHJlcG8gKTtcclxuICAgICAgICAgIH1cclxuICAgICAgICAgIGNhdGNoKCBlICkge1xyXG5cclxuICAgICAgICAgICAgLy8gTGlrZWx5IHRoZXJlIGlzIG5vIHRyYWNraW5nIGluZm8gc2V0IHVwIG9uIHRoZSBsb2NhbCBicmFuY2hcclxuICAgICAgICAgICAgYXdhaXQgZXhlY3V0ZSggJ2dpdCcsIFsgJ2JyYW5jaCcsIGAtLXNldC11cHN0cmVhbS10bz1vcmlnaW4vJHticmFuY2h9YCwgYnJhbmNoIF0sIGAuLi8ke3JlcG99YCApO1xyXG4gICAgICAgICAgICBhd2FpdCBnaXRQdWxsUmViYXNlKCByZXBvICk7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvLyBHbyBiYWNrIHRvIG1haW5cclxuICAgICAgICBhd2FpdCBnaXRDaGVja291dCggcmVwbywgJ21haW4nICk7XHJcbiAgICAgIH1cclxuICAgICAgZWxzZSB7XHJcbiAgICAgICAgYXdhaXQgZ2l0Q2hlY2tvdXQoIHJlcG8sICdtYWluJyApO1xyXG4gICAgICAgIGF3YWl0IGdpdFB1bGxSZWJhc2UoIHJlcG8gKTtcclxuICAgICAgfVxyXG4gICAgfVxyXG4gICAgZWxzZSBpZiAoIHJlcG8gPT09ICdwZXJlbm5pYWwnICkge1xyXG4gICAgICBjb25zb2xlLmxvZyggYCR7cmVkfXBlcmVubmlhbCBpcyBub3QgY2xlYW4sIHNraXBwaW5nIHB1bGwke3Jlc2V0fWAgKTtcclxuICAgIH1cclxuXHJcbiAgICBpZiAoIHJlcG8gPT09ICdwZXJlbm5pYWwnICkge1xyXG4gICAgICBhd2FpdCBjbG9uZU1pc3NpbmdSZXBvcygpO1xyXG4gICAgfVxyXG5cclxuICAgIGNvbnN0IHN5bWJvbGljUmVmID0gKCBhd2FpdCBleGVjdXRlKCAnZ2l0JywgWyAnc3ltYm9saWMtcmVmJywgJy1xJywgJ0hFQUQnIF0sIGAuLi8ke3JlcG99YCApICkudHJpbSgpO1xyXG4gICAgY29uc3QgYnJhbmNoID0gc3ltYm9saWNSZWYucmVwbGFjZSggJ3JlZnMvaGVhZHMvJywgJycgKTsgLy8gbWlnaHQgYmUgZW1wdHkgc3RyaW5nXHJcbiAgICBjb25zdCBzaGEgPSBhd2FpdCBnaXRSZXZQYXJzZSggcmVwbywgJ0hFQUQnICk7XHJcbiAgICBjb25zdCBzdGF0dXMgPSBhd2FpdCBleGVjdXRlKCAnZ2l0JywgWyAnc3RhdHVzJywgJy0tcG9yY2VsYWluJyBdLCBgLi4vJHtyZXBvfWAgKTtcclxuICAgIGNvbnN0IHRyYWNrID0gYnJhbmNoID8gKCBhd2FpdCBleGVjdXRlKCAnZ2l0JywgWyAnZm9yLWVhY2gtcmVmJywgJy0tZm9ybWF0PSUocHVzaDp0cmFjayxub2JyYWNrZXQpJywgc3ltYm9saWNSZWYgXSwgYC4uLyR7cmVwb31gICkgKS50cmltKCkgOiAnJztcclxuXHJcbiAgICBsZXQgaXNHcmVlbiA9IGZhbHNlO1xyXG4gICAgaWYgKCBicmFuY2ggKSB7XHJcbiAgICAgIGlzR3JlZW4gPSAhc3RhdHVzICYmIGJyYW5jaCA9PT0gJ21haW4nICYmICF0cmFjay5sZW5ndGg7XHJcblxyXG4gICAgICBpZiAoICFpc0dyZWVuIHx8IGFsbFJlcG9zICkge1xyXG4gICAgICAgIGRhdGFbIHJlcG8gXSArPSBgJHtyZXBvfSR7bW92ZVJpZ2h0fSR7aXNHcmVlbiA/IGdyZWVuIDogcmVkfSR7YnJhbmNofSR7cmVzZXR9ICR7dHJhY2t9XFxuYDtcclxuICAgICAgfVxyXG4gICAgfVxyXG4gICAgZWxzZSB7XHJcbiAgICAgIC8vIGlmIG5vIGJyYW5jaCwgcHJpbnQgb3VyIFNIQSAoZGV0YWNoZWQgaGVhZClcclxuICAgICAgZGF0YVsgcmVwbyBdICs9IGAke3JlcG99JHttb3ZlUmlnaHR9JHtyZWR9JHtzaGF9JHtyZXNldH1cXG5gO1xyXG4gICAgfVxyXG5cclxuICAgIGlmICggc3RhdHVzICkge1xyXG4gICAgICBpZiAoICFpc0dyZWVuIHx8IGFsbFJlcG9zICkge1xyXG4gICAgICAgIGRhdGFbIHJlcG8gXSArPSBzdGF0dXMgKyAnXFxuJztcclxuICAgICAgfVxyXG4gICAgfVxyXG4gIH1cclxuICBjYXRjaCggZSApIHtcclxuICAgIGRhdGFbIHJlcG8gXSArPSBgJHtyZXBvfSBFUlJPUjogJHtlfWA7XHJcbiAgfVxyXG59O1xyXG5cclxuKCBhc3luYyAoKSA9PiB7XHJcbiAgYXdhaXQgUHJvbWlzZS5hbGwoIHJlcG9zLm1hcCggcmVwbyA9PiBnZXRTdGF0dXMoIHJlcG8gKSApICk7XHJcblxyXG4gIHJlcG9zLmZvckVhY2goIHJlcG8gPT4ge1xyXG4gICAgcHJvY2Vzcy5zdGRvdXQud3JpdGUoIGRhdGFbIHJlcG8gXSApO1xyXG4gIH0gKTtcclxuXHJcbiAgY29uc29sZS5sb2coIGAke18uZXZlcnkoIHJlcG9zLCByZXBvID0+ICFkYXRhWyByZXBvIF0ubGVuZ3RoICkgPyBncmVlbiA6IHJlZH0tLS0tLT09PT09XSBmaW5pc2hlZCBwdWxscyBbPT09PT0tLS0tLSR7cmVzZXR9XFxuYCApO1xyXG5cclxuICBhd2FpdCBucG1VcGRhdGUoICdjaGlwcGVyJyApO1xyXG4gIGF3YWl0IG5wbVVwZGF0ZSggJ3BlcmVubmlhbCcgKTtcclxuICBhd2FpdCBucG1VcGRhdGUoICdwZXJlbm5pYWwtYWxpYXMnICk7XHJcblxyXG4gIGNvbnNvbGUubG9nKCBgJHtfLmV2ZXJ5KCByZXBvcywgcmVwbyA9PiAhZGF0YVsgcmVwbyBdLmxlbmd0aCApID8gZ3JlZW4gOiByZWR9LS0tLS09PT09PV0gZmluaXNoZWQgbnBtIFs9PT09PS0tLS0tJHtyZXNldH1cXG5gICk7XHJcblxyXG4gIGlmICggdHJhbnNwaWxlICkge1xyXG4gICAgYXdhaXQgb3V0cHV0SlNBbGwoKTtcclxuXHJcbiAgICBjb25zb2xlLmxvZyggYCR7Xy5ldmVyeSggcmVwb3MsIHJlcG8gPT4gIWRhdGFbIHJlcG8gXS5sZW5ndGggKSA/IGdyZWVuIDogcmVkfS0tLS0tPT09PT1dIGZpbmlzaGVkIHRyYW5zcGlsZSBbPT09PT0tLS0tLSR7cmVzZXR9XFxuYCApO1xyXG4gIH1cclxufSApKCk7Il0sIm1hcHBpbmdzIjoiQUFBQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBLE1BQU1BLGlCQUFpQixHQUFHQyxPQUFPLENBQUUsNkJBQThCLENBQUM7QUFDbEUsTUFBTUMsT0FBTyxHQUFHRCxPQUFPLENBQUUsbUJBQW9CLENBQUM7QUFDOUMsTUFBTUUsY0FBYyxHQUFHRixPQUFPLENBQUUsMEJBQTJCLENBQUM7QUFDNUQsTUFBTUcsV0FBVyxHQUFHSCxPQUFPLENBQUUsdUJBQXdCLENBQUM7QUFDdEQsTUFBTUksV0FBVyxHQUFHSixPQUFPLENBQUUsdUJBQXdCLENBQUM7QUFDdEQsTUFBTUssVUFBVSxHQUFHTCxPQUFPLENBQUUsc0JBQXVCLENBQUM7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